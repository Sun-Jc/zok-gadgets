from utils import test_circuit


label = '0x00212b23807363a62beef506242a3a0f36ae8d03453bdad1753d39f4799ac83b'
next_label = '0x0c1e0c6f9f26439f106511e695467ad38c5c2070aba2b7adaaabba35b68fba37'
balance = '0x0000000000000000000000000000000000000000000000000000000000000001'
raw_address = '0x0000000000000000000000000000000000000000000000000000000000000000'
slot = '0x0000000000000000000000000000000000000000000000000000000000000000'

proof = [(1, '0x233f6117828bc4237869421569162b44836456860d1db3bdb45d0aba55e72fcb'), (1, '0x0a7593ee787480408d9e73f8dab511afa4f04bf4277f83c5fef5de2369052307'), (1, '0x0a9a7ff6c660dfd3daffa081852d9b6afd22f4ea2b228d867f68659c4e146bc8'), (1, '0x13b33a8e91f09197ad086847fd06b2e5ead003cd85387057d8a7670ff13b3bc3'), (1, '0x14781de81b193e6ce5183e59dbfb649caa79e604825e02554be9c22ded8465a4'), (1, '0x27289a9c44d47dc0f6233fd3f777b69012b4390078601d918e7cfe3852a26092'), (1, '0x113d543e03d49187e0b1c84151f2ea11b396319d51e6cbbf30a2ddb88d04b8dc'), (1, '0x0e24b7668871912cd609be13ad1755dd0993e0b7ea336773671076e7186f8e67'), (1, '0x0f22f5dbc50a484d1891ec14f0b422574f1df3ed15b3597786733523155310ca'), (1, '0x18b93cf90c885f64bae647308b2ee20a99bc71a2528c2f45bbc885cc059332af'), (1, '0x2a000c1538f59ca00d19e1d70befd97fe78f5a7554b1c71061145d2fb2390750'), (1, '0x0ce281169aad7ee71183f1dfdf6aba0178cc30d2123c89d35eb00662bea67795'), (1, '0x02e5213103cefa6e94150fc12e85fdd3fa5bcd71ff88fcb69f21224839314664'), (1, '0x2c5416a1af6329cbb2e999dfe83fd0e16726fae0ed69aaaaafb24a108286c74d'), (1, '0x0bd828e7efa1eceae7b1d01a1c428c7ed2e5167697db014faccd012d9f97b8a2'), (1, '0x2f9e67996cd14d6b8ed9143b19a831e3f09e9c7861202d8525fad4e12d408e8a'), (1, '0x1e497fd4d4b092ee19f7cf698e553c285636429a75165ff817e63cc73566b28d'), (0, '0x046386e21602f6768dd2cdc8fb57fd29e238939050564dbbd3711e78b15d8df1')]
root = '0x2d03340b45245db908c5d6bb782b4cc1ce277e7d3c2ed4340a15e5f76cb5bc85'

def gen_witness(label, next_label, balance, raw_address, slot, proof):
    leaf = ['0x1', label, next_label, balance, raw_address, slot]

    leaf = [int(l, 16) for l in leaf]
    proof = [(p[0], int(p[1], 16)) for p in proof]

    n = len(proof) * 2

    proof += [(0, 0)] * (32 - len(proof))

    witness = ' '.join([str(x) for x in leaf + [n] + [x for p in proof for x in p]])
    return witness

witness = gen_witness(label, next_label, balance, raw_address, slot, proof)

name = 'poseidon-merkle-d32'

test_circuit(name, witness, [(0, root)])